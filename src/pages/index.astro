---
import Layout from '../layouts/Layout.astro';
import Hero from '../components/Hero.astro';
import EvaluationSection from '../components/EvaluationSection.astro';
import FindingsSection from '../components/FindingsSection.astro';
import ProbingSection from '../components/ProbingSection.astro';
import BeliefUpdateSection from '../components/BeliefUpdateSection.astro';
import AuthorsCitation from '../components/AuthorsCitation.astro';

// Import component-specific styles
import '../styles/section.css';
import '../styles/hero.css';
import '../styles/authors.css';
import '../styles/resources.css';
import '../styles/activeExploration.css';

const pageTitle = "Theory of Space";
---
<Layout title={pageTitle}>
  <!-- 1. Teaser Section -->
  <Hero />
  
  <!-- 2. Leaderboard Section -->
  <EvaluationSection />

  <!-- 3. Spatial Belief Probing Section -->
  <ProbingSection />
  
  <!-- 4. Belief Update Section -->
  <BeliefUpdateSection />
  
  <!-- 5. Key Findings Section -->
  <FindingsSection />

  <!-- 6. Citation Section -->
  <AuthorsCitation />
</Layout>

<script>
  import { initCitationCopy } from '../scripts/citation';

  document.addEventListener('DOMContentLoaded', () => {
    // Initialize citation copy functionality
    initCitationCopy();
    
    // Initialize trajectory viewer - Hidden but preserved
    // initTrajectoryViewer();

    // Text animation for hero section
    const animateTitle = () => {
      const titleElement = document.getElementById('animated-title');
      
      if (titleElement) {
        // Handle the new two-line title structure
        const titleLines = titleElement.querySelectorAll('.title-line');
        
        let totalChars = 0;
        titleLines.forEach((line) => {
          const lineText = (line as HTMLElement).innerText;
          (line as HTMLElement).innerHTML = '';
          
          for (let i = 0; i < lineText.length; i++) {
            const charSpan = document.createElement('span');
            charSpan.className = 'reveal-char';
            charSpan.style.animationDelay = `${(totalChars + i) * 0.03}s`;
            
            // Special handling for spaces to ensure they display correctly
            if (lineText[i] === ' ') {
              charSpan.innerHTML = '&nbsp;';
            } else {
              charSpan.innerText = lineText[i];
            }
            
            (line as HTMLElement).appendChild(charSpan);
          }

          totalChars += lineText.length;
        });
      }
    };
    
    // Run animation
    animateTitle();
  });
</script>